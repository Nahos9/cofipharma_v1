import{r as c,j as e,a as E,f as l,J as A}from"./app-DbyA3mvE.js";import"./Dropdown-BFV5wbVP.js";import{C as p,a as j,b as g,c as f}from"./card-yFBQgyHH.js";import{I as F}from"./input-BtDAZA_C.js";import{B as i}from"./button-CWT1gZ8D.js";import{T as M,a as q,b as d,c as a,d as k,e as n}from"./table-DCU5QFQC.js";import{M as B}from"./Modal-Ci-k2C8p.js";import{V as b}from"./index-BKzSqiLt.js";import{V as H}from"./VisiteurLayout-C1zH5-88.js";import{F as I,S as L}from"./search-D-QdisBk.js";import{E as V}from"./eye-Bwq2So-H.js";import"./transition-Cm4bD9Fw.js";import"./clsx-B-dksMZM.js";import"./index-BO6MDd1V.js";import"./createLucideIcon-BIABvqxB.js";const te=({avSalaires:s,filters:r})=>{const[_,u]=c.useState((r==null?void 0:r.search)||""),[v,x]=c.useState((r==null?void 0:r.status)||""),[y,o]=c.useState(!1),[m,h]=c.useState(null),N=t=>{u(t),l.get(route("visiteur.av_salaire.all"),{...r,search:t,page:1},{preserveState:!0})},w=t=>{x(t),l.get(route("visiteur.av_salaire.all"),{...r,status:t,page:1},{preserveState:!0})},C=t=>new Date(t).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),R=t=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XOF"}).format(t),T=()=>{m&&l.delete(route("visiteur.av_salaire.destroy",m),{onSuccess:()=>{o(!1),h(null),b.success("La demande a été supprimée avec succès",{duration:4e3,position:"top-right",style:{background:"#10B981",color:"#fff"}})},onError:()=>{o(!1),h(null),b.error("Une erreur est survenue lors de la suppression de l'avance sur salaire")}})};return e.jsxs(H,{children:[e.jsx(E,{title:"Gestion des avances sur salaire"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gestion des avances sur salaire"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Gérez toutes les demandes d'avances sur salaire des employés"})]})}),e.jsxs(p,{children:[e.jsx(j,{children:e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-5 h-5"}),"Filtres et recherche"]})}),e.jsx(f,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(L,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(F,{placeholder:"Rechercher...",value:_,onChange:t=>N(t.target.value),className:"pl-10"})]}),e.jsxs("select",{value:v,onChange:t=>w(t.target.value),className:"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[e.jsx("option",{value:"",children:"Tous les statuts"}),e.jsx("option",{value:"en attente",children:"En attente"}),e.jsx("option",{value:"accepte",children:"Acceptée"}),e.jsx("option",{value:"rejete",children:"Rejetée"}),e.jsx("option",{value:"débloque",children:"Débloquée"})]}),e.jsx(i,{variant:"outline",onClick:()=>{u(""),x(""),l.get(route("visiteur.av_salaire.all"))},children:"Réinitialiser"})]})})]}),e.jsxs(p,{children:[e.jsx(j,{children:e.jsxs(g,{children:["Avances sur salaire (",(s==null?void 0:s.total)||0,")"]})}),e.jsxs(f,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(M,{children:[e.jsx(q,{children:e.jsxs(d,{children:[e.jsx(a,{children:"Nom et prénom "}),e.jsx(a,{children:"Montant"}),e.jsx(a,{children:"Statut"}),e.jsx(a,{children:"Date de demande"}),e.jsx(a,{children:"Actions"})]})}),e.jsx(k,{children:!(s!=null&&s.data)||s.data.length===0?e.jsx(d,{children:e.jsx(n,{colSpan:7,className:"text-center py-8 text-gray-500",children:"Aucune avance sur salaire trouvée"})}):s.data.map(t=>e.jsxs(d,{className:"hover:bg-gray-50",children:[e.jsx(n,{children:e.jsxs("div",{className:"font-medium",children:[t.nom," ",t.prenom]})}),e.jsx(n,{children:e.jsx("span",{className:"font-semibold text-green-600",children:R(t.montant)})}),e.jsx(n,{children:e.jsx("span",{className:`inline-flex rounded-full px-2 text-xs font-semibold leading-5 ${t.status==="en attente"&&t.user_validateur_level=="charge client"?"bg-yellow-100 text-yellow-800":t.status==="accepte"&&t.user_validateur_level=="responsable_ritel"?"bg-green-100 text-green-800":t.status==="debloque"&&t.user_validateur_level=="operation"?"bg-gray-400 text-white":t.status==="rejete"&&t.user_validateur_level=="operation"||t.status==="rejete"&&t.user_validateur_level=="charge client"?"bg-red-100 text-red-800":t.status==="accepte"&&t.user_validateur_level=="operation"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:(()=>{if(t.status==="en attente"&&t.user_validateur_level=="charge client")return"En attente (chargé(e) de clientèle)";if(t.status==="accepte"&&t.user_validateur_level=="responsable_ritel")return"En attente (Responsable Ritel)";if(t.status==="accepte"&&t.user_validateur_level=="operation")return"En attente (Operation)";if(t.status==="rejete"&&t.user_validateur_level=="operation")return"Rejeté par operation";if(t.status==="rejete"&&t.user_validateur_level=="charge client")return"Rejeté par chargé(e) de clientèle";if(t.status==="rejete"&&t.user_validateur_level=="responsable_ritel")return"Rejeté par responsable Ritel";if(t.status==="debloque")return"Débloqué"})()})}),e.jsx(n,{children:e.jsx("div",{className:"text-sm text-gray-600",children:C(t.created_at)})}),e.jsx(n,{children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(A,{variant:"outline",size:"sm",href:route("visiteur.av_salaire.edit",t.id),children:e.jsx(V,{className:"w-4 h-4"})})})})]},t.id))})]})}),(s==null?void 0:s.last_page)>1&&e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Affichage de ",s.from," à ",s.to," sur ",s.total," résultats"]}),e.jsx("div",{className:"flex items-center gap-2",children:s.links.map((t,D)=>e.jsx(i,{variant:t.active?"default":"outline",size:"sm",disabled:!t.url,onClick:()=>{t.url&&l.get(t.url,{},{preserveState:!0})},dangerouslySetInnerHTML:{__html:t.label}},D))})]})]})]})]}),e.jsx(B,{show:y,onClose:()=>o(!1),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-bold mb-4",children:"Confirmer la suppression"}),e.jsx("p",{children:"Êtes-vous sûr de vouloir supprimer cette avance sur salaire ? Cette action est irréversible."}),e.jsxs("div",{className:"mt-6 flex justify-end gap-2",children:[e.jsx(i,{variant:"outline",onClick:()=>o(!1),children:"Annuler"}),e.jsx(i,{variant:"destructive",onClick:T,children:"Supprimer"})]})]})})]})};export{te as default};
