import{r as i,j as e,a as M,f as a,J as E}from"./app-B0hzU4lX.js";import"./Dropdown-CsSIElTE.js";import{C as p,a as j,b as g,c as f}from"./card-Cwn7vY7G.js";import{I as A}from"./input-DRsQ6LO3.js";import{B as c}from"./button-BDA1yoaQ.js";import{T as F,a as q,b as u,c as o,d as H,e as n}from"./table-_fMBqkxz.js";import{C as I}from"./CaissiereLayout-kJA8yyfr.js";import{M as L}from"./Modal-BFXi_WZX.js";import{a as z,V as b}from"./index-C2du5mlg.js";import{F as B,S as V}from"./search-BkiqolMV.js";import{E as G}from"./eye-BLLutONv.js";import{c as O}from"./createLucideIcon-DuupygLo.js";import"./transition-DuVpHk1f.js";import"./clsx-B-dksMZM.js";import"./disabled-rILpzM3M.js";import"./index-CtHK7raN.js";/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],U=O("trash-2",J),ce=({avSalaires:s,filters:r})=>{const[_,x]=i.useState((r==null?void 0:r.search)||""),[y,h]=i.useState((r==null?void 0:r.status)||""),[v,l]=i.useState(!1),[m,d]=i.useState(null),N=t=>{x(t),a.get(route("responsable_ritel.av_salaire.all"),{...r,search:t,page:1},{preserveState:!0})},w=t=>{h(t),a.get(route("responsable_ritel.av_salaire.all"),{...r,status:t,page:1},{preserveState:!0})},C=t=>{d(t),l(!0)},R=()=>{m&&a.delete(route("av_salaire.destroy",m),{onSuccess:()=>{l(!1),d(null),b.success("La demande a été supprimée avec succès",{duration:4e3,position:"top-right",style:{background:"#10B981",color:"#fff"}})},onError:()=>{l(!1),d(null),b.error("Une erreur est survenue lors de la suppression de l'avance sur salaire")}})},T=t=>new Date(t).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),k=t=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XOF"}).format(t);return e.jsxs(I,{children:[e.jsx(M,{title:"Gestion des avances sur salaire"}),e.jsx(z,{}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gestion des avances sur salaire"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Gérez toutes les demandes d'avances sur salaire"})]})}),e.jsxs(p,{children:[e.jsx(j,{children:e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5"}),"Filtres et recherche"]})}),e.jsx(f,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(V,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(A,{placeholder:"Rechercher...",value:_,onChange:t=>N(t.target.value),className:"pl-10"})]}),e.jsxs("select",{value:y,onChange:t=>w(t.target.value),className:"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[e.jsx("option",{value:"",children:"Tous les statuts"}),e.jsx("option",{value:"en attente",children:"En attente"}),e.jsx("option",{value:"acceptée",children:"Acceptée"}),e.jsx("option",{value:"rejetée",children:"Rejetée"}),e.jsx("option",{value:"débloquée",children:"Débloquée"})]}),e.jsx(c,{variant:"outline",onClick:()=>{x(""),h(""),a.get(route("charge_client.av_salaire.all"))},children:"Réinitialiser"})]})})]}),e.jsxs(p,{children:[e.jsx(j,{children:e.jsxs(g,{children:["Avances sur salaire (",(s==null?void 0:s.total)||0,")"]})}),e.jsxs(f,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(F,{children:[e.jsx(q,{children:e.jsxs(u,{children:[e.jsx(o,{children:"Nom et prénom "}),e.jsx(o,{children:"Montant"}),e.jsx(o,{children:"Statut"}),e.jsx(o,{children:"Date de demande"}),e.jsx(o,{children:"Actions"})]})}),e.jsx(H,{children:!(s!=null&&s.data)||s.data.length===0?e.jsx(u,{children:e.jsx(n,{colSpan:7,className:"text-center py-8 text-gray-500",children:"Aucune avance sur salaire trouvée"})}):s.data.map(t=>e.jsxs(u,{className:"hover:bg-gray-50",children:[e.jsx(n,{children:e.jsxs("div",{className:"font-medium",children:[t.nom," ",t.prenom]})}),e.jsx(n,{children:e.jsx("span",{className:"font-semibold text-green-600",children:k(t.montant)})}),e.jsx(n,{children:e.jsx("span",{className:`inline-flex rounded-full px-2 text-xs font-semibold leading-5 ${t.status==="en attente"&&t.user_validateur_level=="charge client"?"bg-yellow-100 text-yellow-800":t.status==="accepte"&&t.user_validateur_level=="responsable_ritel"?"bg-green-100 text-green-800":t.status==="debloque"&&t.user_validateur_level=="operation"?"bg-gray-400 text-white":t.status==="rejete"&&t.user_validateur_level=="operation"||t.status==="rejete"&&t.user_validateur_level=="charge client"?"bg-red-100 text-red-800":t.status==="accepte"&&t.user_validateur_level=="operation"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:(()=>{if(t.status==="en attente"&&t.user_validateur_level=="charge client")return"En attente (chargé(e) de clientèle)";if(t.status==="accepte"&&t.user_validateur_level=="responsable_ritel")return"En attente (Responsable Ritel)";if(t.status==="accepte"&&t.user_validateur_level=="operation")return"En attente (Operation)";if(t.status==="rejete"&&t.user_validateur_level=="operation")return"Rejeté par operation";if(t.status==="rejete"&&t.user_validateur_level=="charge client")return"Rejeté par chargé(e) de clientèle";if(t.status==="rejete"&&t.user_validateur_level=="responsable_ritel")return"Rejeté par responsable Ritel";if(t.status==="debloque")return"Débloqué"})()})}),e.jsx(n,{children:e.jsx("div",{className:"text-sm text-gray-600",children:T(t.created_at)})}),e.jsx(n,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{variant:"outline",size:"sm",href:route("charge_client.av_salaire.edit",t.id),children:e.jsx(G,{className:"w-4 h-4"})}),t.status=="en attente"&&e.jsx(c,{variant:"destructive",size:"sm",onClick:()=>C(t.id),children:e.jsx(U,{className:"w-4 h-4"})})]})})]},t.id))})]})}),(s==null?void 0:s.last_page)>1&&e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Affichage de ",s.from," à ",s.to," sur ",s.total," résultats"]}),e.jsx("div",{className:"flex items-center gap-2",children:s.links.map((t,D)=>e.jsx(c,{variant:t.active?"default":"outline",size:"sm",disabled:!t.url,onClick:()=>{t.url&&a.get(t.url,{},{preserveState:!0})},dangerouslySetInnerHTML:{__html:t.label}},D))})]})]})]})]}),e.jsx(L,{show:v,onClose:()=>l(!1),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-bold mb-4",children:"Confirmer la suppression"}),e.jsx("p",{children:"Êtes-vous sûr de vouloir supprimer cette avance sur salaire ? Cette action est irréversible."}),e.jsxs("div",{className:"mt-6 flex justify-end gap-2",children:[e.jsx(c,{variant:"outline",onClick:()=>l(!1),children:"Annuler"}),e.jsx(c,{variant:"destructive",onClick:R,children:"Supprimer"})]})]})})]})};export{ce as default};
