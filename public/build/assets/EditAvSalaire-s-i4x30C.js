import{r as m,j as e,a as f,J as p,f as g}from"./app-ChUtNyX1.js";import{C as N,a as v,b as y,d as b,c as _}from"./card-CyJYvmns.js";import{B as i}from"./badge-BSR0wr-X.js";import{B as a}from"./button-DfJcaMOk.js";import{M as C}from"./Modal-xrR0fT_E.js";import{a as w,V as x}from"./index-DBso2tiL.js";import{C as D}from"./ClientLayout-DB4P41oN.js";import{U as A}from"./user-DiZVg2DB.js";import{M}from"./mail-BrHkFs19.js";import{P as R}from"./phone-BMkIepWm.js";import{C as q,a as E}from"./credit-card-BqmOr3aR.js";import{F}from"./file-text-BAOEazwM.js";import{D as T}from"./download-wecWvwXj.js";import"./clsx-B-dksMZM.js";import"./transition-B8Y3k17J.js";import"./disabled-CFosIz57.js";import"./index-Cr8n4pvO.js";import"./Dropdown-LEd-RzhI.js";import"./createLucideIcon-DgrljhpN.js";const h={"en attente":{variant:"secondary",text:"En attente"},acceptée:{variant:"default",text:"Acceptée"},rejetée:{variant:"destructive",text:"Rejetée"},débloquée:{variant:"default",text:"Débloquée"}},k=t=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XOF"}).format(t),B=t=>new Date(t).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),te=({avSalaire:t})=>{h[t.status]||h["en attente"];const[u,c]=m.useState(!1),[r,l]=m.useState(null),j=()=>{g.post(route("client.av_salaire.validate",t.id),{_method:"PUT",status:r},{onSuccess:()=>{c(!1),l(null),x.success("La demande a été validée avec succès",{duration:2e3,position:"top-right",style:{background:"#10B981",color:"#fff"}})},onError:s=>{c(!1),l(null),x.error("Une erreur est survenue lors de la validation de l'avance sur salaire")}})},d=()=>{c(!1),l(null)};return e.jsxs(D,{children:[e.jsx(f,{title:"Détail de l'avance sur salaire"}),e.jsx(w,{}),e.jsxs("div",{className:"mx-auto mt-8",children:[e.jsx("div",{className:"mb-4 flex items-center gap-2",children:e.jsx(p,{href:route("client.av_salaire.all"),children:e.jsx(a,{variant:"outline",size:"sm",children:"← Retour"})})}),e.jsxs(N,{children:[e.jsxs(v,{children:[e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-6 h-6 text-blue-600"}),t.nom," ",t.prenom,t.status==="en attente"&&e.jsx(i,{variant:"secondary",children:"En attente"}),t.status==="accepte"&&e.jsx(i,{variant:"default",children:"Acceptée"}),t.status==="rejete"&&e.jsx(i,{variant:"destructive",children:"Rejetée"}),t.status==="débloque"&&e.jsx(i,{variant:"default",children:"Débloquée"})]}),e.jsx(b,{children:"Détail de la demande d'avance sur salaire"})]}),e.jsxs(_,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:t.email})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:t.phone})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:t.numero_compte})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:B(t.created_at)})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"font-semibold text-green-600",children:k(t.montant)})})]}),e.jsxs("div",{className:"mt-6 space-y-4",children:[t.status=="debloque"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2 flex items-center gap-2",children:"Signature"}),t.piece_joints_av&&t.piece_joints_av.filter(s=>s.category==="signature").length>0?e.jsx("div",{className:"flex items-center gap-4 bg-gray-50 rounded p-3",children:t.piece_joints_av.filter(s=>s.category==="signature").map((s,o)=>{const n=s.chemin_fichier.startsWith("http")?s.chemin_fichier:`/storage/${s.chemin_fichier}`;return e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("img",{src:n,alt:"Signature",className:"h-20 object-contain border rounded bg-white"})},o)})}):e.jsx("div",{className:"text-gray-500",children:"Aucune signature enregistrée"})]}),t.status=="debloque"?e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-2 flex items-center gap-2",children:[e.jsx(F,{className:"w-5 h-5 text-gray-700"})," Contrats"]}),t.piece_joints_av&&t.piece_joints_av.filter(s=>s.category==="contract").length>0?e.jsx("ul",{className:"space-y-2",children:t.piece_joints_av.filter(s=>s.category==="contract").map((s,o)=>{const n=s.chemin_fichier.startsWith("http")?s.chemin_fichier:`/storage/${s.chemin_fichier}`;return s.is_signed,e.jsxs("li",{className:"flex items-center gap-3 bg-gray-50 rounded p-2",children:[e.jsx("span",{className:"truncate flex-1",children:s.nom_fichier}),e.jsx("a",{href:n,target:"_blank",rel:"noopener noreferrer",children:e.jsx(a,{variant:"secondary",size:"sm",className:"flex items-center gap-1",children:"Visualiser"})}),e.jsx("a",{href:n,target:"_blank",rel:"noopener noreferrer",download:!0,children:e.jsxs(a,{variant:"outline",size:"sm",className:"flex items-center gap-1",children:[e.jsx(T,{className:"w-4 h-4"})," Télécharger"]})})]},o)})}):e.jsx("div",{className:"text-gray-500",children:"Aucun contrat généré"})]}):e.jsx("div",{children:e.jsx("p",{className:"text-gray-500",children:"Votre contrat est en attente de signature."})})]})]})]})]}),e.jsx(C,{show:u,onClose:d,maxWidth:"sm",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:r==="accepte"?"Confirmer la validation":"Confirmer le rejet"}),e.jsxs("p",{className:"mb-6",children:["Êtes-vous sûr de vouloir ",r==="accepte"?"valider":"rejeter"," cette avance sur salaire ? Cette action est irréversible."]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(a,{variant:"outline",onClick:d,children:"Annuler"}),e.jsx(a,{variant:r==="accepte"?"default":"destructive",onClick:j,children:r==="accepte"?"Valider":"Rejeter"})]})]})})]})};export{te as default};
