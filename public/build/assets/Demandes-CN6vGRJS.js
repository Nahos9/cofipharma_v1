import{r as c,S as me,j as e,a as pe,f as K}from"./app-ChUtNyX1.js";import{y as m,N as ue,L as xe,F as he}from"./FooterHome-D59b6zYI.js";import{r as ge}from"./docx-preview-C00Jo0WL.js";import"./button-DfJcaMOk.js";import"./clsx-B-dksMZM.js";import"./createLucideIcon-DgrljhpN.js";import"./x-Bila_xqa.js";import"./mail-BrHkFs19.js";import"./phone-BMkIepWm.js";const ke=()=>{const[g,T]=c.useState([]),[l,C]=c.useState(1),[p,S]=c.useState(null),[P,Y]=c.useState(""),[U,G]=c.useState(""),[k,Q]=c.useState(""),[F,Z]=c.useState(""),[A,$]=c.useState(!1),[f,M]=c.useState(""),[V,z]=c.useState(!1),b=c.useRef(null),h=c.useRef(null),D=c.useRef(!1),v=c.useRef({x:0,y:0}),{data:n,setData:r,processing:R,errors:s}=me({first_name:"",last_name:"",email:"",montant:"",numero_compte:"",phone:"",carte:"",mode_paiement:"",civility:"",address:"",city:"",bp:"",piece_identite:"",numero_piece_identite:"",date_naissance:"",lieu_naissance:"",nationalite:"",profession:"",employeur:"",date_de_delivrance_piece_identite:"",files:[]});c.useEffect(()=>{Object.keys(s).length>0&&m.error("Veuillez corriger les erreurs dans le formulaire",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})},[s]);const ee=a=>{const t=Array.from(a.target.files);T(t),r(i=>({...i,files:t}))},te=async()=>{var a,t,i,o;try{const d=window.PUBLIC_BASE||((t=(a=import.meta)==null?void 0:a.env)==null?void 0:t.VITE_PUBLIC_BASE)||"";let j="";if(p)try{const w=atob(p.split(",")[1]),le=p.split(",")[0].split(":")[1].split(";")[0],X=new ArrayBuffer(w.length),oe=new Uint8Array(X);for(let u=0;u<w.length;u++)oe[u]=w.charCodeAt(u);const ce=new Blob([X],{type:le}),H=new FormData;H.append("signature",ce,"preview-signature.png");const de=((i=document.querySelector('meta[name="csrf-token"]'))==null?void 0:i.getAttribute("content"))||((o=window.Laravel)==null?void 0:o.csrfToken)||"",q=(u=>{const J=document.cookie.match(new RegExp("(?:^|; )"+u.replace(/([.$?*|{}()\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return J?decodeURIComponent(J[1]):""})("XSRF-TOKEN"),W=await fetch(route("contracts.previewSignatureUpload"),{method:"POST",body:H,headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":de||q,"X-XSRF-TOKEN":q},credentials:"same-origin"});W.ok&&(j=(await W.json()).signature_relative_path||"")}catch{}const _=new URLSearchParams({first_name:n.first_name||"",last_name:n.last_name||"",email:n.email||"",numero_compte:n.numero_compte||"",montant:String(n.montant||""),phone:n.phone||"",mode_paiement:n.mode_paiement||"",date_de_delivrance_piece_identite:n.date_de_delivrance_piece_identite||"",date_naissance:n.date_naissance||"",lieu_naissance:n.lieu_naissance||"",nationalite:n.nationalite||"",profession:n.profession||"",employeur:n.employeur||"",civility:n.civility||"",address:n.address||"",city:n.city||"",bp:n.bp||"",piece_identite:n.piece_identite||"",numero_piece_identite:n.numero_piece_identite||"",signature_relative_path:j||""});d&&_.set("public_base",d);const x=`${route("contracts.previewDocx")}?${_.toString()}`,I=await fetch(x,{method:"GET",headers:{Accept:"application/json"}});if(!I.ok)throw new Error("Pr√©visualisation DOCX indisponible");const N=await I.json();Y(N.office_view_url||""),G(N.google_view_url||""),Z(N.docx_relative_url||""),Q(N.docx_url||"")}catch{m.error("Impossible de charger le pr√©visualiseur du contrat")}},ae=async a=>{if(a==null||a.preventDefault(),l===1&&(!n.first_name||!n.email||!n.numero_compte||!n.montant)){m.warn("Veuillez remplir les champs requis de l'√©tape 1.");return}if(l===3&&!p){m.warn("Veuillez signer avant de continuer.");return}const t=Math.min(5,l+1);C(t),t===4&&await te()},y=()=>{const a=h.current;if(!a)return;const t=window.devicePixelRatio||1,i=a.getBoundingClientRect();a.width=i.width*t,a.height=i.height*t;const o=a.getContext("2d");o.scale(t,t),o.lineWidth=2,o.lineCap="round",o.strokeStyle="#111827",o.fillStyle="#ffffff",o.fillRect(0,0,i.width,i.height)};c.useEffect(()=>(y(),window.addEventListener("resize",y),()=>window.removeEventListener("resize",y)),[]);const B=(a,t)=>{const i=a.getBoundingClientRect(),o=t.touches?t.touches[0].clientX:t.clientX,d=t.touches?t.touches[0].clientY:t.clientY;return{x:o-i.left,y:d-i.top}},L=a=>{const t=h.current;t&&(D.current=!0,v.current=B(t,a))},O=a=>{const t=h.current;if(!t||!D.current)return;const i=t.getContext("2d"),{x:o,y:d}=B(t,a);i.beginPath(),i.moveTo(v.current.x,v.current.y),i.lineTo(o,d),i.stroke(),v.current={x:o,y:d},a.preventDefault()},E=()=>{D.current=!1},ne=()=>{y(),S(null)},se=()=>{const a=h.current;if(!a)return;a.getBoundingClientRect();const t=a.toDataURL("image/png");if(!t){m.warn("Veuillez ajouter une signature.");return}S(t),m.success("Signature enregistr√©e.")},ie=a=>{if(a.preventDefault(),l===5){if(!V){m.warn("Veuillez cocher la case d'acceptation.");return}if((f||"").trim().toLowerCase()!=="j‚Äôai lu et approuv√©"&&(f||"").trim().toLowerCase()!=="j'ai lu et approuv√©"){m.warn('Veuillez saisir exactement: "J‚Äôai lu et approuv√©".');return}}const t=new FormData;t.append("first_name",n.first_name),t.append("last_name",n.last_name),t.append("email",n.email),t.append("numero_compte",n.numero_compte),t.append("montant",n.montant),t.append("phone",n.phone),t.append("mode_paiement",n.mode_paiement),t.append("civility",n.civility),t.append("address",n.address),t.append("city",n.city),t.append("bp",n.bp),t.append("piece_identite",n.piece_identite),t.append("numero_piece_identite",n.numero_piece_identite),t.append("date_naissance",n.date_naissance),t.append("lieu_naissance",n.lieu_naissance),t.append("nationalite",n.nationalite),t.append("profession",n.profession),t.append("employeur",n.employeur),t.append("dure","1"),t.append("carte",n.carte),t.append("date_de_delivrance_piece_identite",n.date_de_delivrance_piece_identite),t.append("mention_text",f),t.append("mention_accepted",V?"1":"0"),n.files.forEach((i,o)=>{t.append(`files[${o}]`,i)});try{if(p){const i=atob(p.split(",")[1]),o=p.split(",")[0].split(":")[1].split(";")[0],d=new ArrayBuffer(i.length),j=new Uint8Array(d);for(let x=0;x<i.length;x++)j[x]=i.charCodeAt(x);const _=new Blob([d],{type:o||"image/png"});t.append("signature",_,"signature.png")}}catch{}K.post(route("demandes.store"),t,{forceFormData:!0,onSuccess:()=>{r({first_name:"",last_name:"",email:"",montant:"",phone:"",numero_compte:"",mode_paiement:"",mention_text:"",mention_accepted:"",mention_accepted_at:"",civility:"",address:"",city:"",bp:"",piece_identite:"",numero_piece_identite:"",date_naissance:"",lieu_naissance:"",nationalite:"",profession:"",employeur:"",dure:"",carte:"",date_de_delivrance_piece_identite:"",signature:"",files:[]}),T([]),S(null),M(""),z(!1),C(1),m.success("üéâ Votre demande a √©t√© envoy√©e avec succ√®s.",{position:"top-right"}),setTimeout(()=>{K.visit(route("welcome"))},1200)},onError:()=>{m.error("Une erreur est survenue lors de l'envoi de la demande")}})},re=l===1?20:l===2?40:l===3?60:l===4?80:100;return c.useEffect(()=>{(async()=>{if(!(l!==4||!F&&!k||!b.current))try{const i=await fetch(F||k,{credentials:"same-origin"});if(!i.ok)throw new Error("Docx non accessible");const d=await(await i.blob()).arrayBuffer();b.current.innerHTML="",await ge(d,b.current,void 0,{className:"docx-view",inWrapper:!0,ignoreWidth:!1,ignoreHeight:!1}),$(!1)}catch{$(!0)}})()},[l,k,F]),e.jsxs("div",{className:"min-h-screen w-100 bg-gray-100",children:[e.jsx(pe,{title:"Demandes"}),e.jsx(ue,{}),e.jsx(xe,{position:"top-right",autoClose:5e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"}),e.jsxs("div",{className:"max-w-6xl mx-auto p-4 sm:p-6 w-100",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold mb-4 sm:mb-6 text-gray-800 text-center sm:text-left",children:"Nouvelle Demande Cofi'Pharma"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${re}%`}})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mt-2",children:[e.jsx("span",{children:"√âtape 1: Formulaire"}),e.jsx("span",{children:"√âtape 2: R√©capitulatif"}),e.jsx("span",{children:"√âtape 3: Signature"}),e.jsx("span",{children:"√âtape 4: Contrat"}),e.jsx("span",{children:"√âtape 5: Acceptation"})]})]}),e.jsxs("form",{className:"bg-white shadow-md rounded-lg px-4 sm:px-8 pt-6 pb-8 mb-4",onSubmit:l===5?ie:ae,children:[l===1&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4 ",children:[e.jsx("label",{htmlFor:"civility",children:"Civilit√©"}),e.jsxs("select",{name:"civility",id:"civility",onChange:a=>{r(t=>({...t,civility:a.target.value}))},value:n.civility,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",children:[e.jsx("option",{value:"",children:"S√©lectionnez"}),e.jsx("option",{value:"mr",children:"Mr"}),e.jsx("option",{value:"mme",children:"Mme"})]})]}),e.jsxs("div",{className:"mb-4 grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"nom",children:"Nom (*)"}),e.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline ${s.first_name?"border-red-500":""}`,id:"nom",type:"text",placeholder:"Votre nom",onChange:a=>{r(t=>({...t,first_name:a.target.value}))},value:n.first_name}),s.first_name&&e.jsx("p",{className:"text-red-500 text-xs italic mt-1",children:s.first_name})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"prenom",children:"Pr√©nom"}),e.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline ${s.last_name?"border-red-500":""}`,id:"prenom",type:"text",placeholder:"Votre pr√©nom",onChange:a=>{r(t=>({...t,last_name:a.target.value}))},value:n.last_name}),s.last_name&&e.jsx("p",{className:"text-red-500 text-xs italic mt-1",children:s.last_name})]})]}),e.jsxs("div",{className:"mb-4 grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"nom",children:"Date de naissance"}),e.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline ${s.first_name?"border-red-500":""}`,id:"date_naissance",type:"date",placeholder:"Votre date de naissance",onChange:a=>{r(t=>({...t,date_naissance:a.target.value}))},value:n.date_naissance}),s.date_naissance&&e.jsx("p",{className:"text-red-500 text-xs italic mt-1",children:s.date_naissance})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"prenom",children:"Lieu de naissance"}),e.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline ${s.lieu_naissance?"border-red-500":""}`,id:"lieu_naissance",type:"text",placeholder:"Votre lieu de naissance",onChange:a=>{r(t=>({...t,lieu_naissance:a.target.value}))},value:n.lieu_naissance}),s.lieu_naissance&&e.jsx("p",{className:"text-red-500 text-xs italic mt-1",children:s.lieu_naissance})]})]}),e.jsxs("div",{className:"mb-4 grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"nom",children:"Piece d'identit√©"}),e.jsxs("select",{className:`shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline ${s.piece_identite?"border-red-500":""}`,name:"piece_identite",id:"piece_identite",onChange:a=>{r(t=>({...t,piece_identite:a.target.value}))},value:n.piece_identite,children:[e.jsx("option",{value:"",children:"S√©lectionnez"}),e.jsx("option",{value:"cni",children:"Carte nationale d'identit√©"}),e.jsx("option",{value:"passport",children:"Passport"}),e.jsx("option",{value:"permis de conduire",children:"Permis de conduire"}),e.jsx("option",{value:"cart_sej",children:"Carte de s√©jour"})]}),s.piece_identite&&e.jsx("p",{className:"text-red-500 text-xs italic mt-1",children:s.piece_identite})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"prenom",children:"Num√©ro de la piece d'identit√©"}),e.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline ${s.numero_piece_identite?"border-red-500":""}`,id:"numero_piece_identite",type:"text",placeholder:"Votre num√©ro de la piece d'identit√©",onChange:a=>{r(t=>({...t,numero_piece_identite:a.target.value}))},value:n.numero_piece_identite}),s.numero_piece_identite&&e.jsx("p",{className:"text-red-500 text-xs italic mt-1",children:s.numero_piece_identite})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"date_de_delivrance_piece_identite",children:"Date de delivrance de la piece d'identit√©"}),e.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline ${s.first_name?"border-red-500":""}`,id:"date_de_delivrance_piece_identite",type:"date",placeholder:"Votre date de delivrance de la piece d'identit√©",onChange:a=>{r(t=>({...t,date_de_delivrance_piece_identite:a.target.value}))},value:n.date_de_delivrance_piece_identite}),s.date_de_delivrance_piece_identite&&e.jsx("p",{className:"text-red-500 text-xs italic mt-1",children:s.date_de_delivrance_piece_identite})]})]}),e.jsxs("div",{className:"mb-4 grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"email",children:"Email (*)"}),e.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline ${s.email?"border-red-500":""}`,id:"email",type:"email",placeholder:"Votre email",onChange:a=>{r(t=>({...t,email:a.target.value}))},value:n.email}),s.email&&e.jsx("p",{className:"text-red-500 text-xs italic mt-1",children:s.email})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"numero_compte",children:"Num√©ro de compte courant (*)"}),e.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline ${s.numero_compte?"border-red-500":""}`,id:"numero_compte",type:"text",inputMode:"numeric",placeholder:"Votre num√©ro de compte",pattern:"^371.*",onInvalid:a=>a.currentTarget.setCustomValidity("Le num√©ro de compte doit commencer par 371"),onInput:a=>a.currentTarget.setCustomValidity(""),onChange:a=>{const t=a.target.value;t&&!t.startsWith("371")?a.target.setCustomValidity("Le num√©ro de compte doit commencer par 371"):a.target.setCustomValidity(""),r(i=>({...i,numero_compte:t}))},value:n.numero_compte,required:!0}),s.numero_compte&&e.jsx("p",{className:"text-red-500 text-xs italic mt-1",children:s.numero_compte})]})]}),e.jsxs("div",{className:"mb-4 grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"nationalite",children:"Nationalit√©"}),e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"nationalite",type:"text",placeholder:"Votre nationalit√©",onChange:a=>{r(t=>({...t,nationalite:a.target.value}))},value:n.nationalite})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"profession",children:"Profession"}),e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"profession",type:"text",placeholder:"Votre profession",onChange:a=>{r(t=>({...t,profession:a.target.value}))},value:n.profession})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"employeur",children:"Employeur"}),e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"employeur",type:"text",placeholder:"Votre employeur",onChange:a=>{r(t=>({...t,employeur:a.target.value}))},value:n.employeur})]})]}),e.jsxs("div",{className:"mb-4 grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"address",children:"Adresse"}),e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"address",type:"text",placeholder:"Votre adresse",onChange:a=>{r(t=>({...t,address:a.target.value}))},value:n.address})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"city",children:"Ville"}),e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"city",type:"text",placeholder:"Votre ville",onChange:a=>{r(t=>({...t,city:a.target.value}))},value:n.city})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"bp",children:"BP"}),e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"bp",type:"text",placeholder:"Votre BP",onChange:a=>{r(t=>({...t,bp:a.target.value}))},value:n.bp})]})]}),e.jsxs("div",{className:"mb-4 grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"telephone",children:"T√©l√©phone"}),e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"telephone",type:"tel",placeholder:"Votre num√©ro de t√©l√©phone",onChange:a=>{r(t=>({...t,phone:a.target.value}))},value:n.phone})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"montant",children:"Mode de paiement (*)"}),e.jsxs("select",{className:`shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline ${s.montant?"border-red-500":""}`,value:n.mode_paiement,onChange:a=>r(t=>({...t,mode_paiement:a.target.value})),children:[e.jsx("option",{value:"",children:"S√©lectionnez"}),e.jsx("option",{value:"caisse",children:"Caisse"}),e.jsx("option",{value:"mobile",children:"Mobile monaie"}),e.jsx("option",{value:"carte",children:"Carte pr√©pay√©e"})]})]}),n.mode_paiement=="mobile"&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"telephone",children:"Num√©ro de t√©l√©phone (*)"}),e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"telephone",type:"tel",placeholder:"Votre num√©ro de t√©l√©phone",onChange:a=>{r(t=>({...t,phone:a.target.value}))},value:n.phone})]}),n.mode_paiement=="carte"&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"carte",children:"Num√©ro de la carte (*)"}),e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"carte",type:"text",placeholder:"Num√©ro de la carte",onChange:a=>{r(t=>({...t,carte:a.target.value}))},value:n.carte})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"montant",children:"Montant (*)"}),e.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline ${s.montant?"border-red-500":""}`,id:"montant",type:"number",step:"0.01",placeholder:"Montant de la demande",onChange:a=>{r(t=>({...t,montant:a.target.value}))},value:n.montant}),s.montant&&e.jsx("p",{className:"text-red-500 text-xs italic mt-1",children:s.montant})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"files",children:"Documents (PDF, Images) (*)"}),e.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline ${s.files?"border-red-500":""}`,id:"files",type:"file",multiple:!0,accept:".pdf,.jpg,.jpeg,.png",onChange:ee}),s.files&&e.jsx("p",{className:"text-red-500 text-xs italic mt-1",children:s.files}),g.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Fichiers s√©lectionn√©s :"}),e.jsx("ul",{className:"mt-1 text-sm text-gray-500",children:g.map((a,t)=>e.jsxs("li",{className:"flex items-center",children:[e.jsx("span",{className:"mr-2",children:"‚Ä¢"}),a.name," (",(a.size/1024).toFixed(2)," KB)"]},t))})]})]})]}),l===2&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"R√©capitulatif"}),e.jsxs("div",{className:"bg-gray-50 rounded border border-gray-200 p-4",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"Nom:"})," ",e.jsxs("strong",{children:[n.first_name," ",n.last_name]})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"Email:"})," ",e.jsx("strong",{children:n.email})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"Compte:"})," ",e.jsx("strong",{children:n.numero_compte})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"T√©l√©phone:"})," ",e.jsx("strong",{children:n.phone||"-"})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"Mode paiement:"})," ",e.jsx("strong",{children:n.mode_paiement||"-"})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"Montant:"})," ",e.jsx("strong",{children:n.montant})]}),g.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Documents joints:"}),e.jsx("ul",{className:"mt-1 text-sm text-gray-500 list-disc list-inside",children:g.map((a,t)=>e.jsx("li",{children:a.name},t))})]})]})]}),l===3&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Signature"}),e.jsxs("div",{className:"bg-gray-50 rounded border border-gray-200 p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-start",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"border rounded bg-white",children:e.jsx("canvas",{ref:h,className:"w-full h-48 touch-none",onMouseDown:L,onMouseMove:O,onMouseUp:E,onMouseLeave:E,onTouchStart:L,onTouchMove:O,onTouchEnd:E})}),e.jsxs("div",{className:"mt-2 flex gap-2",children:[e.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:ne,children:"Effacer"}),e.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:se,children:"Enregistrer la signature"})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Aper√ßu"}),e.jsx("div",{className:"border rounded bg-white flex items-center justify-center h-48",children:p?e.jsx("img",{src:p,alt:"Signature",className:"max-h-44 object-contain"}):e.jsx("span",{className:"text-xs text-gray-400",children:"Aucune signature enregistr√©e"})})]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Signez dans l'encadr√© ci-dessus. Utilisez votre souris ou votre doigt (mobile)."})]})]}),l===4&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Aper√ßu du contrat"}),e.jsx("div",{className:"bg-gray-50 rounded border border-gray-200 p-2",children:e.jsxs("div",{className:"relative w-full",style:{minHeight:"40vh"},children:[!A&&e.jsx("div",{ref:b,className:"docx-container w-full h-full overflow-auto",style:{maxHeight:"70vh"}}),A&&(P||U)&&e.jsx("div",{className:"w-full",style:{height:"70vh"},children:e.jsx("iframe",{title:"Aper√ßu du contrat",src:P||U,style:{width:"100%",height:"100%",border:0},allow:"fullscreen"})})]})})]}),l===5&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Acceptation"}),e.jsxs("div",{className:"bg-gray-50 rounded border border-gray-200 p-4 text-sm text-gray-700 leading-relaxed max-h-56 overflow-auto",children:[e.jsx("p",{children:"En validant, vous confirmez l'exactitude des informations fournies et acceptez les termes du contrat de financement CofiExpress. Vous autorisez la v√©rification de vos donn√©es et l'utilisation de vos documents pour l'√©tude de votre dossier."}),e.jsx("p",{className:"mt-2",children:"Saisissez ¬´ J‚Äôai lu et approuv√© ¬ª et cochez la case pour confirmer."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Texte d‚Äôacceptation"}),e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",placeholder:"J‚Äôai lu et approuv√©",value:f,onChange:a=>M(a.target.value)}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx("input",{id:"acceptTerms",type:"checkbox",checked:V,onChange:a=>z(a.target.checked)}),e.jsx("label",{htmlFor:"acceptTerms",className:"text-sm text-gray-700",children:"Je confirme avoir lu et approuv√©"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsx("button",{type:"button",className:`px-4 py-2 rounded bg-gray-200 hover:bg-gray-300 text-gray-800 ${l===1?"opacity-50 cursor-not-allowed":""}`,onClick:a=>{a.preventDefault(),C(t=>Math.max(1,t-1))},disabled:l===1,children:"√âtape pr√©c√©dente"}),e.jsx("button",{className:`px-4 py-2 rounded text-white ${l===5?"bg-green-600 hover:bg-green-700":"bg-blue-500 hover:bg-blue-700"} ${R?"opacity-50 cursor-not-allowed":""}`,type:"submit",disabled:R,children:R?"Traitement...":l===5?"Soumettre la demande":"Continuer"})]})]})]}),e.jsx(he,{})]})};export{ke as default};
