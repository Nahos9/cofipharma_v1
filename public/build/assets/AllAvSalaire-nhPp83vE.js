import{r as i,j as e,a as E,f as o,J as A}from"./app-hTjhDnw6.js";import"./Dropdown-P4Z_Q8rB.js";import{C as p,a as j,b as g,c as f}from"./card-CRBSPu0F.js";import{I as F}from"./input-CNrKAXxR.js";import{B as a}from"./button-BOHDd86f.js";import{T as M,a as k,b as u,c,d as q,e as n}from"./table-Bwdcwm2N.js";import{M as z}from"./Modal-gO77NSOo.js";import{O as B}from"./OperationLayout-LC1JdKXv.js";import{F as H,S as I}from"./search-DVEzqPIc.js";import{E as L}from"./eye-BvqrrP2S.js";import{T as O}from"./trash-BHkY2Eij.js";import"./transition-CfoIMK9o.js";import"./clsx-B-dksMZM.js";import"./disabled-BtTB0I82.js";import"./index-DlnidHJY.js";import"./createLucideIcon-C96OzZRC.js";const re=({avSalaires:s,filters:r})=>{const[b,m]=i.useState((r==null?void 0:r.search)||""),[_,x]=i.useState((r==null?void 0:r.status)||""),[y,l]=i.useState(!1),[h,d]=i.useState(null),N=t=>{m(t),o.get(route("operation.av_salaire.all"),{...r,search:t,page:1},{preserveState:!0})},v=t=>{d(t),l(!0)},w=t=>{x(t),o.get(route("operation.av_salaire.all"),{...r,status:t,page:1},{preserveState:!0})},C=t=>new Date(t).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),R=t=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XOF"}).format(t),T=()=>{h&&o.delete(route("operation.av_salaire.destroy",h),{onSuccess:()=>{l(!1),d(null),toast.success("La demande a été supprimée avec succès",{duration:4e3,position:"top-right",style:{background:"#10B981",color:"#fff"}})},onError:()=>{l(!1),d(null),toast.error("Une erreur est survenue lors de la suppression de l'avance sur salaire")}})};return e.jsxs(B,{children:[e.jsx(E,{title:"Gestion des avances sur salaire"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gestion des avances sur salaire"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Gérez toutes les demandes d'avances sur salaire des employés"})]})}),e.jsxs(p,{children:[e.jsx(j,{children:e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(H,{className:"w-5 h-5"}),"Filtres et recherche"]})}),e.jsx(f,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(I,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(F,{placeholder:"Rechercher...",value:b,onChange:t=>N(t.target.value),className:"pl-10"})]}),e.jsxs("select",{value:_,onChange:t=>w(t.target.value),className:"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[e.jsx("option",{value:"",children:"Tous les statuts"}),e.jsx("option",{value:"en attente",children:"En attente"}),e.jsx("option",{value:"accepte",children:"Acceptée"}),e.jsx("option",{value:"rejetée",children:"Rejetée"}),e.jsx("option",{value:"débloquée",children:"Débloquée"})]}),e.jsx(a,{variant:"outline",onClick:()=>{m(""),x(""),o.get(route("operation.av_salaire.all"))},children:"Réinitialiser"})]})})]}),e.jsxs(p,{children:[e.jsx(j,{children:e.jsxs(g,{children:["Avances sur salaire (",(s==null?void 0:s.total)||0,")"]})}),e.jsxs(f,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(M,{children:[e.jsx(k,{children:e.jsxs(u,{children:[e.jsx(c,{children:"Nom et prénom "}),e.jsx(c,{children:"Montant"}),e.jsx(c,{children:"Statut"}),e.jsx(c,{children:"Date de demande"}),e.jsx(c,{children:"Actions"})]})}),e.jsx(q,{children:!(s!=null&&s.data)||s.data.length===0?e.jsx(u,{children:e.jsx(n,{colSpan:7,className:"text-center py-8 text-gray-500",children:"Aucune avance sur salaire trouvée"})}):s.data.map(t=>e.jsxs(u,{className:"hover:bg-gray-50",children:[e.jsx(n,{children:e.jsxs("div",{className:"font-medium",children:[t.nom," ",t.prenom]})}),e.jsx(n,{children:e.jsx("span",{className:"font-semibold text-green-600",children:R(t.montant)})}),e.jsx(n,{children:e.jsx("span",{className:`inline-flex rounded-full px-2 text-xs font-semibold leading-5 ${t.status==="en attente"&&t.user_validateur_level=="charge client"?"bg-yellow-100 text-yellow-800":t.status==="accepte"&&t.user_validateur_level=="operation"?"bg-green-100 text-green-800":t.status==="debloque"&&t.user_validateur_level=="operation"?"bg-gray-400 text-white":t.status==="rejete"&&t.user_validateur_level=="operation"||t.status==="rejete"&&t.user_validateur_level=="charge client"?"bg-red-100 text-red-800":t.status==="accepte"&&t.user_validateur_level=="operation"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:(()=>{if(t.status==="en attente"&&t.user_validateur_level=="charge client")return"En attente (chargé(e) de clientèle)";if(t.status==="accepte"&&t.user_validateur_level=="responsable_ritel")return"En attente (Responsable Ritel | Chef d'agence)";if(t.status==="accepte"&&t.user_validateur_level=="operation")return"En attente (Operation)";if(t.status==="rejete"&&t.user_validateur_level=="operation")return"Rejeté par operation";if(t.status==="rejete"&&t.user_validateur_level=="charge client")return"Rejeté par chargé(e) de clientèle";if(t.status==="rejete"&&t.user_validateur_level=="responsable_ritel")return"Rejeté par responsable Ritel | Chef d'agence";if(t.status==="debloque")return"Débloqué"})()})}),e.jsx(n,{children:e.jsx("div",{className:"text-sm text-gray-600",children:C(t.created_at)})}),e.jsx(n,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{variant:"outline",size:"sm",href:route("operation.av_salaire.edit",t.id),children:e.jsx(L,{className:"w-4 h-4"})}),t.status==="en attente"&&e.jsx(a,{variant:"destructive",size:"sm",onClick:()=>v(t.id),children:e.jsx(O,{className:"w-4 h-4"})})]})})]},t.id))})]})}),(s==null?void 0:s.last_page)>1&&e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Affichage de ",s.from," à ",s.to," sur ",s.total," résultats"]}),e.jsx("div",{className:"flex items-center gap-2",children:s.links.map((t,D)=>e.jsx(a,{variant:t.active?"default":"outline",size:"sm",disabled:!t.url,onClick:()=>{t.url&&o.get(t.url,{},{preserveState:!0})},dangerouslySetInnerHTML:{__html:t.label}},D))})]})]})]})]}),e.jsx(z,{show:y,onClose:()=>l(!1),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-bold mb-4",children:"Confirmer la suppression"}),e.jsx("p",{children:"Êtes-vous sûr de vouloir supprimer cette avance sur salaire ? Cette action est irréversible."}),e.jsxs("div",{className:"mt-6 flex justify-end gap-2",children:[e.jsx(a,{variant:"outline",onClick:()=>l(!1),children:"Annuler"}),e.jsx(a,{variant:"destructive",onClick:T,children:"Supprimer"})]})]})})]})};export{re as default};
