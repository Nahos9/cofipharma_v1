import{r as l,j as e,a as S,J as D,f as u}from"./app-D-K7TukB.js";import{a as F,c as d}from"./index-B67YcRbI.js";import{C as L}from"./ClientLayout-DBQDGCZZ.js";import{F as f}from"./file-text-DlPa4AG9.js";import{D as p}from"./download-Rl_pPjkX.js";import{C as M}from"./check-DEf_Qgb0.js";import{O as E,I as R}from"./octagon-x-Ce9Z2I5U.js";import"./Dropdown-BZpkpdh6.js";import"./transition-CpEP3GKq.js";import"./createLucideIcon-DDjgJCFR.js";const T=({demande:t})=>{const j=s=>{const r=(s.nom_fichier||"").toLowerCase(),o=(s.type_mime||"").toLowerCase();return r.startsWith("signature_")||r.includes("signature")?"signature":r.includes("contrat")||r.includes("contract")||o==="application/pdf"?"contract":"other"},i=(t.piece_jointes||[]).map(s=>({...s,category:s.category||j(s)})),[y,m]=l.useState(!1),[w,c]=l.useState(!1),[a,x]=l.useState(null),[n,h]=l.useState(null),b=s=>{switch(s){case"en attente":return"bg-yellow-100 text-yellow-800";case"accepte":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},N=s=>{switch(s){case"en attente":return"En attente";case"accepte":return"Approuvé";case"rejected":return"Rejeté";default:return s}},v=()=>{a&&u.post(route("demandes.validateOrReject",a.id),{_method:"PUT",status:"debloque"},{onSuccess:()=>{m(!1),x(null),d.success("La demande a été debloquée avec succès",{duration:4e3,position:"top-right",style:{background:"#10B981",color:"#fff"}})},onError:s=>{s.status===419?window.location.href=route("login"):d.error("Une erreur est survenue lors de la validation",{duration:4e3,position:"top-right",style:{background:"#EF4444",color:"#fff"}})}})},_=()=>{n&&u.post(route("demandes.validateOrReject",n.id),{_method:"PUT",status:"rejete"},{onSuccess:()=>{c(!1),h(null),d.success("La demande a été rejetée avec succès",{duration:4e3,position:"top-right",style:{background:"#EF4444",color:"#fff"}})},onError:s=>{s.status===419?window.location.href=route("login"):d.error("Une erreur est survenue lors du rejet",{duration:4e3,position:"top-right",style:{background:"#EF4444",color:"#fff"}})}})},[A,W]=l.useState(null),C=s=>s.startsWith("image/")?e.jsx(R,{className:"h-6 w-6 text-blue-500"}):e.jsx(f,{className:"h-6 w-6 text-blue-500"}),k=s=>{if(s===0)return"0 Bytes";const r=1024,o=["Bytes","KB","MB","GB"],g=Math.floor(Math.log(s)/Math.log(r));return parseFloat((s/Math.pow(r,g)).toFixed(2))+" "+o[g]};return e.jsxs(L,{header:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:["Détails de la demande # ",t.first_name,"  ",t.last_name]}),e.jsx("div",{className:"flex space-x-4",children:e.jsx(D,{href:route("client.demandes.all"),className:"inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:"Retour à la liste"})})]}),children:[e.jsx(S,{title:`Détails de la demande #${t.id}`}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:e.jsx("div",{className:"overflow-hidden bg-white shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:"Informations générales"}),e.jsxs("dl",{className:"mt-5 grid grid-cols-1 gap-5 sm:grid-cols-2",children:[e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white px-4 py-5 shadow sm:p-6",children:[e.jsx("dt",{className:"truncate text-sm font-medium text-gray-500",children:"N° demande"}),e.jsx("dd",{className:"mt-1 text-3xl font-semibold text-gray-900",children:t.id})]}),e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white px-4 py-5 shadow sm:p-6",children:[e.jsx("dt",{className:"truncate text-sm font-medium text-gray-500",children:"Statut"}),e.jsx("dd",{className:"mt-1",children:e.jsx("span",{className:`inline-flex rounded-full px-2 text-xs font-semibold leading-5 ${b(t.status)}`,children:N(t.status)})})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:"Informations du demandeur"}),e.jsxs("dl",{className:"mt-5 grid grid-cols-1 gap-5 sm:grid-cols-2",children:[e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white px-4 py-5 shadow sm:p-6",children:[e.jsx("dt",{className:"truncate text-sm font-medium text-gray-500",children:"Nom"}),e.jsx("dd",{className:"mt-1 text-xl font-semibold text-gray-900",children:t.first_name})]}),e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white px-4 py-5 shadow sm:p-6",children:[e.jsx("dt",{className:"truncate text-sm font-medium text-gray-500",children:"Email"}),e.jsx("dd",{className:"mt-1  font-semibold text-gray-900",children:t.email})]})]})]})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:"Détails de la demande"}),e.jsxs("div",{className:"mt-5 grid grid-cols-1 gap-5 sm:grid-cols-2",children:[e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white px-4 py-5 shadow sm:p-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Montant demande"}),e.jsxs("dd",{className:"mt-1 text-lg text-gray-900",children:[t.montant," FCFA"]})]}),e.jsxs("div",{className:"overflow-hidden lt-1 rounded-lg bg-white px-4 py-5 shadow sm:p-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Numéro de compte"}),e.jsx("dd",{className:"mt-1 text-lg text-gray-900 whitespace-pre-wrap",children:t.numero_compte})]})]}),e.jsxs("div",{className:"mt-5 grid grid-cols-1 gap-5 sm:grid-cols-2",children:[e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white px-4 py-5 shadow sm:p-6",children:[e.jsx("dt",{className:"text-xl font-medium text-gray-500",children:"Mode de paiement"}),e.jsx("dd",{className:"mt-1 text-xl font-semibold text-gray-900",children:t.mode_paiement})]}),t.mode_paiement=="mobile"&&e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white px-4 py-5 shadow sm:p-6",children:[e.jsx("dt",{className:"text-xl font-medium text-gray-500",children:"Numéro de téléphone"}),e.jsx("dd",{className:"mt-1 text-xl font-semibold text-gray-900",children:t.phone})]}),t.mode_paiement=="carte"&&e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white px-4 py-5 shadow sm:p-6",children:[e.jsx("dt",{className:"text-xl font-medium text-gray-500",children:"Numéro carte"}),e.jsx("dd",{className:"mt-1 text-xl font-semibold text-gray-900",children:t.numero_carte})]})]})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:"Dates"}),e.jsxs("dl",{className:"mt-5 grid grid-cols-1 gap-5 sm:grid-cols-2",children:[e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white px-4 py-5 shadow sm:p-6",children:[e.jsx("dt",{className:"truncate text-sm font-medium text-gray-500",children:"Date de création"}),e.jsx("dd",{className:"mt-1 text-lg text-gray-900",children:new Date(t.created_at).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white px-4 py-5 shadow sm:p-6",children:[e.jsx("dt",{className:"truncate text-sm font-medium text-gray-500",children:"Dernière modification"}),e.jsx("dd",{className:"mt-1 text-lg text-gray-900",children:new Date(t.updated_at).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:"Pièces jointes"}),t.status=="debloque"?e.jsxs("div",{className:"mt-5 space-y-8",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-2",children:"Signature"}),i&&i.filter(s=>s.category==="signature").length>0?e.jsx("div",{className:"flex flex-wrap items-center gap-4 bg-gray-50 rounded p-3",children:i.filter(s=>s.category==="signature").map(s=>{const r=(s.chemin_fichier||"").startsWith("http")?s.chemin_fichier:`/storage/${s.chemin_fichier}`;return e.jsx("div",{className:"flex items-center gap-3",children:s.type_mime&&s.type_mime.startsWith("image/")?e.jsx("img",{src:r,alt:"Signature",className:"h-20 object-contain border rounded bg-white"}):e.jsxs("a",{href:r,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center rounded-md bg-white px-2.5 py-1.5 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50",children:[e.jsx(f,{className:"h-4 w-4 mr-1"})," Voir la signature"]})},s.id)})}):e.jsx("div",{className:"text-gray-500",children:"Aucune signature enregistrée"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-2",children:"Contrats"}),i&&i.filter(s=>s.category==="contract"||(s.chemin_fichier||"").toLowerCase().includes("contrats")||(s.chemin_fichier||"").toLowerCase().includes("contrat")||(s.type_mime||"").toLowerCase().includes("application/msword")||(s.type_mime||"").toLowerCase().includes("officedocument.wordprocessingml.document")).length>0?e.jsx("ul",{className:"space-y-2",children:i.filter(s=>s.category==="contract"||(s.chemin_fichier||"").toLowerCase().includes("contrats")||(s.chemin_fichier||"").toLowerCase().includes("contrat")||(s.type_mime||"").toLowerCase().includes("application/msword")||(s.type_mime||"").toLowerCase().includes("officedocument.wordprocessingml.document")).map(s=>{const r=(s.chemin_fichier||"").startsWith("http")?s.chemin_fichier:`/storage/${s.chemin_fichier}`;return e.jsxs("li",{className:"flex items-center gap-3 bg-gray-50 rounded p-3",children:[e.jsx("span",{className:"truncate flex-1",children:s.nom_fichier}),e.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center rounded-md bg-white px-2.5 py-1.5 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50",children:"Visualiser"}),e.jsxs("a",{href:r,target:"_blank",rel:"noopener noreferrer",download:!0,className:"inline-flex items-center rounded-md bg-white px-2.5 py-1.5 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50",children:[e.jsx(p,{className:"h-4 w-4 mr-1"})," Télécharger"]})]},s.id)})}):e.jsx("div",{className:"text-gray-500",children:"Aucun contrat généré"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-2",children:"Autres pièces jointes"}),i&&i.filter(s=>s.category==="other").length>0?e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:i.filter(s=>s.category==="other").map(s=>e.jsxs("div",{className:"relative flex items-center space-x-3 rounded-lg border border-gray-300 bg-white px-6 py-5 shadow-sm hover:border-gray-400",children:[e.jsx("div",{className:"flex-shrink-0",children:C(s.type_mime)}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:s.nom_fichier}),e.jsx("p",{className:"text-sm text-gray-500",children:k(s.taille_fichier)})]}),e.jsxs("div",{className:"flex-shrink-0 flex gap-2",children:[e.jsx("a",{href:(s.chemin_fichier||"").startsWith("http")?s.chemin_fichier:`/storage/${s.chemin_fichier}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center rounded-md bg-white px-2.5 py-1.5 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50",children:"Visualiser"}),e.jsxs("a",{href:(s.chemin_fichier||"").startsWith("http")?s.chemin_fichier:`/storage/${s.chemin_fichier}`,download:s.nom_fichier,className:"inline-flex items-center rounded-md bg-white px-2.5 py-1.5 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50",children:[e.jsx(p,{className:"h-4 w-4 mr-1"}),"Télécharger"]})]})]},s.id))}):e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-gray-500",children:"Aucune pièce jointe disponible"})})]})]}):e.jsx("div",{children:e.jsx("p",{className:"text-gray-500",children:"Votre contrat est en attente de signature."})})]})]})})})}),e.jsx(F,{}),y&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex min-h-screen items-end justify-center px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:e.jsx("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),e.jsx("span",{className:"hidden sm:inline-block sm:h-screen sm:align-middle","aria-hidden":"true",children:"​"}),e.jsxs("div",{className:"inline-block transform overflow-hidden rounded-lg bg-white text-left align-bottom shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:align-middle",children:[e.jsx("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx(M,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[e.jsx("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:"Confirmer le debloquage"}),e.jsx("div",{className:"mt-2",children:e.jsxs("p",{className:"text-sm text-gray-500",children:["Êtes-vous sûr de vouloir debloquer la demande de ",a==null?void 0:a.first_name," ",a==null?void 0:a.last_name," ? Cette action est irréversible."]})})]})]})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6",children:[e.jsx("button",{type:"button",onClick:v,className:"inline-flex w-full justify-center rounded-md border border-transparent bg-green-600 px-4 py-2 text-base font-medium text-white shadow-sm hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 sm:ml-3 sm:w-auto sm:text-sm",children:"Debloquer"}),e.jsx("button",{type:"button",onClick:()=>{m(!1),x(null)},className:"mt-3 inline-flex w-full justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-base font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Annuler"})]})]})]})}),w&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex min-h-screen items-end justify-center px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:e.jsx("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),e.jsx("span",{className:"hidden sm:inline-block sm:h-screen sm:align-middle","aria-hidden":"true",children:"​"}),e.jsxs("div",{className:"inline-block transform overflow-hidden rounded-lg bg-white text-left align-bottom shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:align-middle",children:[e.jsx("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx(E,{className:"h-6 w-6 text-red-600"})}),e.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[e.jsx("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:"Confirmer le rejet"}),e.jsx("div",{className:"mt-2",children:e.jsxs("p",{className:"text-sm text-gray-500",children:["Êtes-vous sûr de vouloir rejeter la demande de ",n==null?void 0:n.first_name," ",n==null?void 0:n.last_name," ? Cette action est irréversible."]})})]})]})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6",children:[e.jsx("button",{type:"button",onClick:_,className:"inline-flex w-full justify-center rounded-md border border-transparent bg-red-600 px-4 py-2 text-base font-medium text-white shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 sm:ml-3 sm:w-auto sm:text-sm",children:"Rejeter"}),e.jsx("button",{type:"button",onClick:()=>{c(!1),h(null)},className:"mt-3 inline-flex w-full justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-base font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Annuler"})]})]})]})})]})};export{T as default};
