import{r as m,j as e,a as g,J as N,f as x}from"./app-DRiTC23B.js";import{C as y,a as v,b as _,d as b,c as C}from"./card-CNPkKnrT.js";import{B as c}from"./badge-9OziumdH.js";import{B as r}from"./button-DQMh-or3.js";import{M as w}from"./Modal-B08kzz9a.js";import{a as D,V as h}from"./index-BdJcsglG.js";import{C as k}from"./ClientLayout-CoGGaYyJ.js";import{U as F}from"./user-C-aFUz_U.js";import{M}from"./mail-FP5sM5Ww.js";import{P as A}from"./phone-Cn3h0zpT.js";import{C as R,a as T}from"./credit-card-C9LRRRxG.js";import{F as E}from"./file-text-CwyZHsXT.js";import{C as q}from"./circle-check-yjo_hJ5Z.js";import{D as B}from"./download-BCXs6Uly.js";import{c as U}from"./createLucideIcon-edNvA3rJ.js";import"./clsx-B-dksMZM.js";import"./transition-B2SWfw9G.js";import"./disabled-B_ODe-u8.js";import"./index-BRCYZbNt.js";import"./Dropdown-fOO3v305.js";/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],V=U("upload",L),p={"en attente":{variant:"secondary",text:"En attente"},acceptée:{variant:"default",text:"Acceptée"},rejetée:{variant:"destructive",text:"Rejetée"},débloquée:{variant:"default",text:"Débloquée"}},z=s=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XOF"}).format(s),P=s=>new Date(s).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),ce=({avSalaire:s})=>{p[s.status]||p["en attente"];const[u,l]=m.useState(!1),[n,o]=m.useState(null),f=()=>{x.post(route("client.av_salaire.validate",s.id),{_method:"PUT",status:n},{onSuccess:()=>{l(!1),o(null),h.success("La demande a été validée avec succès",{duration:2e3,position:"top-right",style:{background:"#10B981",color:"#fff"}})},onError:t=>{l(!1),o(null),h.error("Une erreur est survenue lors de la validation de l'avance sur salaire")}})},d=()=>{l(!1),o(null)};return e.jsxs(k,{children:[e.jsx(g,{title:"Détail de l'avance sur salaire"}),e.jsx(D,{}),e.jsxs("div",{className:"mx-auto mt-8",children:[e.jsx("div",{className:"mb-4 flex items-center gap-2",children:e.jsx(N,{href:route("client.av_salaire.all"),children:e.jsx(r,{variant:"outline",size:"sm",children:"← Retour"})})}),e.jsxs(y,{children:[e.jsxs(v,{children:[e.jsxs(_,{className:"flex items-center gap-2",children:[e.jsx(F,{className:"w-6 h-6 text-blue-600"}),s.nom," ",s.prenom,s.status==="en attente"&&e.jsx(c,{variant:"secondary",children:"En attente"}),s.status==="accepte"&&e.jsx(c,{variant:"default",children:"Acceptée"}),s.status==="rejete"&&e.jsx(c,{variant:"destructive",children:"Rejetée"}),s.status==="débloque"&&e.jsx(c,{variant:"default",children:"Débloquée"})]}),e.jsx(b,{children:"Détail de la demande d'avance sur salaire"})]}),e.jsxs(C,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:s.email})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:s.phone})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:s.numero_compte})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:P(s.created_at)})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"font-semibold text-green-600",children:z(s.montant)})})]}),e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-2 flex items-center gap-2",children:[e.jsx(E,{className:"w-5 h-5 text-gray-700"})," Contrats"]}),s.piece_joints_av&&s.piece_joints_av.filter(t=>t.category==="contract").length>0?e.jsx("ul",{className:"space-y-2",children:s.piece_joints_av.filter(t=>t.category==="contract").map((t,a)=>{const i=t.chemin_fichier.startsWith("http")?t.chemin_fichier:`/storage/${t.chemin_fichier}`,j=!!t.is_signed;return e.jsxs("li",{className:"flex items-center gap-3 bg-gray-50 rounded p-2",children:[e.jsx("span",{className:"truncate flex-1",children:t.nom_fichier}),j?e.jsxs("span",{className:"inline-flex items-center gap-1 text-green-600 text-sm",children:[e.jsx(q,{className:"w-4 h-4"})," Signé"]}):e.jsx("span",{className:"text-amber-600 text-sm",children:"Non signé"}),e.jsx("a",{href:i,target:"_blank",rel:"noopener noreferrer",children:e.jsx(r,{variant:"secondary",size:"sm",className:"flex items-center gap-1",children:"Visualiser"})}),e.jsx("a",{href:i,target:"_blank",rel:"noopener noreferrer",download:!0,children:e.jsxs(r,{variant:"outline",size:"sm",className:"flex items-center gap-1",children:[e.jsx(B,{className:"w-4 h-4"})," Télécharger"]})})]},a)})}):e.jsx("div",{className:"text-gray-500",children:"Aucun contrat généré"})]}),e.jsxs("div",{className:"pt-2 border-t",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Ajouter un contrat signé"}),e.jsxs("form",{onSubmit:t=>{t.preventDefault();const a=t.currentTarget.querySelector("input[type=file]");if(!a||!a.files||a.files.length===0)return;const i=new FormData;i.append("signed_contract",a.files[0]),x.post(route("charge_client.av_salaire.uploadSignedContract",s.id),i,{forceFormData:!0})},className:"flex items-center gap-2",children:[e.jsx("input",{type:"file",accept:".pdf,.doc,.docx",className:"flex-1 text-sm",disabled:(s.piece_joints_av||[]).some(t=>t.category==="contract"&&t.is_signed)}),e.jsxs(r,{type:"submit",className:"flex items-center gap-1",disabled:(s.piece_joints_av||[]).some(t=>t.category==="contract"&&t.is_signed),children:[e.jsx(V,{className:"w-4 h-4"})," Charger"]})]})]})]})]})]})]}),e.jsx(w,{show:u,onClose:d,maxWidth:"sm",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:n==="accepte"?"Confirmer la validation":"Confirmer le rejet"}),e.jsxs("p",{className:"mb-6",children:["Êtes-vous sûr de vouloir ",n==="accepte"?"valider":"rejeter"," cette avance sur salaire ? Cette action est irréversible."]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(r,{variant:"outline",onClick:d,children:"Annuler"}),e.jsx(r,{variant:n==="accepte"?"default":"destructive",onClick:f,children:n==="accepte"?"Valider":"Rejeter"})]})]})})]})};export{ce as default};
