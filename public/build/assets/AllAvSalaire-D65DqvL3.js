import{r as i,j as e,a as A,f as a,J as F}from"./app-t3jM6zF_.js";import{R as M}from"./ResponsableLayout-BHCIF_MK.js";import{C as p,a as j,b as g,c as f}from"./card-EitrJWA0.js";import{I as k}from"./input-CRUGkUGy.js";import{B as o}from"./button-CfEnVg8s.js";import{T as q,a as z,b as u,c,d as B,e as n}from"./table-D4b_kPyX.js";import{M as H}from"./Modal-1UDa7NJh.js";import{V as b}from"./index-BOTgbIkq.js";import{F as I,S as L}from"./search-gyTzHICK.js";import{E as G}from"./eye-DszOYWUy.js";import{T as J}from"./trash-BJmwiL_m.js";import"./Dropdown-FFK2l9bx.js";import"./transition-B2kppIXy.js";import"./clsx-B-dksMZM.js";import"./disabled-Ch2Rg0Xi.js";import"./index-DZUpjVwS.js";import"./createLucideIcon-CA_Mx48d.js";const le=({avSalaires:s,filters:r})=>{const[_,m]=i.useState((r==null?void 0:r.search)||""),[y,x]=i.useState((r==null?void 0:r.status)||""),[N,l]=i.useState(!1),[h,d]=i.useState(null),v=t=>{m(t),a.get(route("responsable_ritel.av_salaire.all"),{...r,search:t,page:1},{preserveState:!0})},w=t=>{d(t),l(!0)},C=t=>{x(t),a.get(route("responsable_ritel.av_salaire.all"),{...r,status:t,page:1},{preserveState:!0})},R=t=>new Date(t).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),T=t=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XOF"}).format(t),D=()=>{h&&a.delete(route("responsable_ritel.av_salaire.destroy",h),{onSuccess:()=>{l(!1),d(null),b.success("La demande a été supprimée avec succès",{duration:4e3,position:"top-right",style:{background:"#10B981",color:"#fff"}})},onError:()=>{l(!1),d(null),b.error("Une erreur est survenue lors de la suppression de l'avance sur salaire")}})};return e.jsxs(M,{children:[e.jsx(A,{title:"Gestion des avances sur salaire"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gestion des avances sur salaire"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Gérez toutes les demandes d'avances sur salaire des employés"})]})}),e.jsxs(p,{children:[e.jsx(j,{children:e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-5 h-5"}),"Filtres et recherche"]})}),e.jsx(f,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(L,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(k,{placeholder:"Rechercher...",value:_,onChange:t=>v(t.target.value),className:"pl-10"})]}),e.jsxs("select",{value:y,onChange:t=>C(t.target.value),className:"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[e.jsx("option",{value:"",children:"Tous les statuts"}),e.jsx("option",{value:"en attente",children:"En attente"}),e.jsx("option",{value:"accepte",children:"Acceptée"}),e.jsx("option",{value:"rejete",children:"Rejetée"}),e.jsx("option",{value:"débloque",children:"Débloquée"})]}),e.jsx(o,{variant:"outline",onClick:()=>{m(""),x(""),a.get(route("responsable_ritel.av_salaire.all"))},children:"Réinitialiser"})]})})]}),e.jsxs(p,{children:[e.jsx(j,{children:e.jsxs(g,{children:["Avances sur salaire (",(s==null?void 0:s.total)||0,")"]})}),e.jsxs(f,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(q,{children:[e.jsx(z,{children:e.jsxs(u,{children:[e.jsx(c,{children:"Nom et prénom "}),e.jsx(c,{children:"Montant"}),e.jsx(c,{children:"Statut"}),e.jsx(c,{children:"Date de demande"}),e.jsx(c,{children:"Actions"})]})}),e.jsx(B,{children:!(s!=null&&s.data)||s.data.length===0?e.jsx(u,{children:e.jsx(n,{colSpan:7,className:"text-center py-8 text-gray-500",children:"Aucune avance sur salaire trouvée"})}):s.data.map(t=>e.jsxs(u,{className:"hover:bg-gray-50",children:[e.jsx(n,{children:e.jsxs("div",{className:"font-medium",children:[t.nom," ",t.prenom]})}),e.jsx(n,{children:e.jsx("span",{className:"font-semibold text-green-600",children:T(t.montant)})}),e.jsx(n,{children:e.jsx("span",{className:`inline-flex rounded-full px-2 text-xs font-semibold leading-5 ${t.status==="en attente"&&t.user_validateur_level=="charge client"?"bg-yellow-100 text-yellow-800":t.status==="accepte"&&t.user_validateur_level=="responsable_ritel"?"bg-green-100 text-green-800":t.status==="debloque"&&t.user_validateur_level=="operation"?"bg-gray-400 text-white":t.status==="rejete"&&t.user_validateur_level=="operation"||t.status==="rejete"&&t.user_validateur_level=="charge client"?"bg-red-100 text-red-800":t.status==="accepte"&&t.user_validateur_level=="operation"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:(()=>{if(t.status==="en attente"&&t.user_validateur_level=="charge client")return"En attente (chargé(e) de clientèle)";if(t.status==="accepte"&&t.user_validateur_level=="responsable_ritel")return"En attente (Responsable Ritel)";if(t.status==="accepte"&&t.user_validateur_level=="operation")return"En attente (Operation)";if(t.status==="rejete"&&t.user_validateur_level=="operation")return"Rejeté par operation";if(t.status==="rejete"&&t.user_validateur_level=="charge client")return"Rejeté par chargé(e) de clientèle";if(t.status==="rejete"&&t.user_validateur_level=="responsable_ritel")return"Rejeté par responsable Ritel";if(t.status==="debloque")return"Débloqué"})()})}),e.jsx(n,{children:e.jsx("div",{className:"text-sm text-gray-600",children:R(t.created_at)})}),e.jsx(n,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{variant:"outline",size:"sm",href:route("responsable_ritel.av_salaire.edit",t.id),children:e.jsx(G,{className:"w-4 h-4"})}),t.status==="en attente"&&e.jsx(o,{variant:"destructive",size:"sm",onClick:()=>w(t.id),children:e.jsx(J,{className:"w-4 h-4"})})]})})]},t.id))})]})}),(s==null?void 0:s.last_page)>1&&e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Affichage de ",s.from," à ",s.to," sur ",s.total," résultats"]}),e.jsx("div",{className:"flex items-center gap-2",children:s.links.map((t,E)=>e.jsx(o,{variant:t.active?"default":"outline",size:"sm",disabled:!t.url,onClick:()=>{t.url&&a.get(t.url,{},{preserveState:!0})},dangerouslySetInnerHTML:{__html:t.label}},E))})]})]})]})]}),e.jsx(H,{show:N,onClose:()=>l(!1),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-bold mb-4",children:"Confirmer la suppression"}),e.jsx("p",{children:"Êtes-vous sûr de vouloir supprimer cette avance sur salaire ? Cette action est irréversible."}),e.jsxs("div",{className:"mt-6 flex justify-end gap-2",children:[e.jsx(o,{variant:"outline",onClick:()=>l(!1),children:"Annuler"}),e.jsx(o,{variant:"destructive",onClick:D,children:"Supprimer"})]})]})})]})};export{le as default};
