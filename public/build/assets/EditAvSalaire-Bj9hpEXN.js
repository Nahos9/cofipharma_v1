import{r as d,j as e,a as g,J as v,f as N}from"./app-IlUcRzel.js";import{C as y,a as C,b,d as _,c as w}from"./card-D_P4HZe-.js";import{B as l}from"./badge-cXce7ICv.js";import{B as a}from"./button-T2iQtihg.js";import{R as D}from"./ResponsableLayout-dshSQnS1.js";import{M as R}from"./Modal-Bqix4jzu.js";import{a as k,V as m}from"./index-C3lzzGoj.js";import{U as A}from"./user-LOzix1sL.js";import{M}from"./mail-WRGFpPmI.js";import{P as E}from"./phone-Dnu-lJeB.js";import{C as F,a as T}from"./credit-card-BwgbKS3o.js";import{F as B}from"./file-text-Q-EKikCj.js";import{C as V}from"./circle-check-Cn51CqfA.js";import{D as q}from"./download-OchRVDww.js";import"./clsx-B-dksMZM.js";import"./Dropdown-DFmBP1VB.js";import"./transition-PuZaeOir.js";import"./disabled-DzvbXCaP.js";import"./index-vUt4R1QX.js";import"./createLucideIcon-CeHlE1ZC.js";const x={"en attente":{variant:"secondary",text:"En attente"},acceptée:{variant:"default",text:"Acceptée"},rejetée:{variant:"destructive",text:"Rejetée"},débloquée:{variant:"default",text:"Débloquée"}},z=s=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XOF"}).format(s),U=s=>new Date(s).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),ne=({avSalaire:s})=>{x[s.status]||x["en attente"];const[h,n]=d.useState(!1),[r,i]=d.useState(null),c=t=>{i(t),n(!0)},u=()=>{N.post(route("responsable_ritel.av_salaire.validate",s.id),{_method:"PUT",status:r},{onSuccess:()=>{n(!1),i(null),m.success("La demande a été validée avec succès",{duration:2e3,position:"top-right",style:{background:"#10B981",color:"#fff"}})},onError:t=>{n(!1),i(null),m.error("Une erreur est survenue lors de la validation de l'avance sur salaire")}})},o=()=>{n(!1),i(null)};return e.jsxs(D,{children:[e.jsx(g,{title:"Détail de l'avance sur salaire"}),e.jsx(k,{}),e.jsxs("div",{className:"max-w-4xl mx-auto mt-8",children:[e.jsx("div",{className:"mb-4 flex items-center gap-2",children:e.jsx(v,{href:route("responsable_ritel.av_salaire.all"),children:e.jsx(a,{variant:"outline",size:"sm",children:"← Retour"})})}),e.jsxs(y,{children:[e.jsxs(C,{children:[e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-6 h-6 text-blue-600"}),s.nom," ",s.prenom,s.status==="en attente"&&e.jsx(l,{variant:"secondary",children:"En attente"}),s.status==="accepte"&&e.jsx(l,{variant:"default",children:"Acceptée"}),s.status==="rejete"&&e.jsx(l,{variant:"destructive",children:"Rejetée"}),s.status==="débloquée"&&e.jsx(l,{variant:"default",children:"Débloquée"}),s.status=="accepte"&&s.user_validateur_level=="responsable_ritel"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(a,{variant:"default",size:"sm",onClick:()=>c("accepte"),children:"Valider"}),e.jsx(a,{variant:"destructive",size:"sm",onClick:()=>c("rejete"),children:"Rejeter"})]})]}),e.jsx(_,{children:"Détail de la demande d'avance sur salaire"})]}),e.jsxs(w,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:s.email})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:s.phone})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:s.numero_compte})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:U(s.created_at)})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"font-semibold text-green-600",children:z(s.montant)})})]}),e.jsx("div",{className:"mt-6 space-y-4",children:e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-2 flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5 text-gray-700"})," Contrats"]}),s.piece_joints_av&&s.piece_joints_av.filter(t=>t.category==="contract").length>0?e.jsx("ul",{className:"space-y-2",children:s.piece_joints_av.filter(t=>t.category==="contract").map((t,p)=>{const j=t.chemin_fichier.startsWith("http")?t.chemin_fichier:`/storage/${t.chemin_fichier}`,f=!!t.is_signed;return e.jsxs("li",{className:"flex items-center gap-3 bg-gray-50 rounded p-2",children:[e.jsx("span",{className:"truncate flex-1",children:t.nom_fichier}),f?e.jsxs("span",{className:"inline-flex items-center gap-1 text-green-600 text-sm",children:[e.jsx(V,{className:"w-4 h-4"})," Signé"]}):e.jsx("span",{className:"text-amber-600 text-sm",children:"Non signé"}),e.jsx("a",{href:j,target:"_blank",rel:"noopener noreferrer",download:!0,children:e.jsxs(a,{variant:"outline",size:"sm",className:"flex items-center gap-1",children:[e.jsx(q,{className:"w-4 h-4"})," Télécharger"]})})]},p)})}):e.jsx("div",{className:"text-gray-500",children:"Aucun contrat généré"})]})})]})]})]}),e.jsx(R,{show:h,onClose:o,maxWidth:"sm",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:r==="accepte"?"Confirmer la validation":"Confirmer le rejet"}),e.jsxs("p",{className:"mb-6",children:["Êtes-vous sûr de vouloir ",r==="accepte"?"valider":"rejeter"," cette avance sur salaire ? Cette action est irréversible."]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(a,{variant:"outline",onClick:o,children:"Annuler"}),e.jsx(a,{variant:r==="accepte"?"default":"destructive",onClick:u,children:r==="accepte"?"Valider":"Rejeter"})]})]})})]})};export{ne as default};
